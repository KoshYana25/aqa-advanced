name: Run Tests in Docker

on:
  push:
    branches:
      - "*"
  pull_request:

jobs:
  cypress-tests:
    runs-on: ubuntu-22.04
    container:
      image: cypress/browsers:node-20.9.0-chrome-118.0.5993.88-1-ff-118.0.2-edge-118.0.2088.46-1
    steps:
      - name: Checkout code
        uses: actions/checkout@v3
      - name: Cache Cypress binary
        uses: actions/cache@v3
        with:
          path: ~/.cache/Cypress
          key: ${{ runner.os }}-cypress-${{ hashFiles('**/package-lock.json') }}
          restore-keys: |
            ${{ runner.os }}-cypress-
      - name: Install dependencies and Cypress binary
        working-directory: ./homework_30
        run: |
          npm install
          npx cypress install
      - name: Run Cypress tests
        working-directory: ./homework_30
        run: npx cypress run --config-file cypress.config.js

  playwright-tests:
    runs-on: ubuntu-22.04
    container:
      image: mcr.microsoft.com/playwright:v1.49.1-jammy
    steps:
      - name: Checkout code
        uses: actions/checkout@v3
      - name: Install dependencies
        working-directory: ./homework_24
        run: npm install @playwright/test
      - name: Run Playwright tests
        working-directory: ./homework_24
        run: npx playwright test
